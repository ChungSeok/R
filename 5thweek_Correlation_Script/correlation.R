##*********************************?????Ð¼?***********************************##

setwd("C:\\Users\\82105\\Desktop\\correlation")

##??Å°?? ??Ä¡(??À»????)
install.packages("Hmisc")
install.packages("ggm")
install.packages("ggplot2")
install.packages("polycor")

##??Å°?? ????
library(boot)
library(ggm)
library(ggplot2)
library(Hmisc)
library(polycor)

## ?Ú·??Ô·? (?? ?????? ???????? ??, ?? ??Àº ?? ?????? ?Ú·?)
adverts<-c(5,4,4,6,8)
packets<-c(8,9,10,13,15)
advertData<-data.frame(adverts, packets)
# Ã¹??Â° ????Àº ???? 5??, ???? 8????

cov(advertData)
# ?????? ?????? ??Àº ?Ð»?
# 4.25(adverts x packets)?? ?? ???? ???Ð»?

var(adverts)
# adverts?? ?Ð»?var(packets)
?? À§?? ???? 2.8?? ????


## ?Ð¼? ?????Í¿? ????Ä¡?? ??À» ????

adverts<-c(5,4,4,6,8)
packetsNA<-c(8,9,10,NA,15)
# ?????Í¿? ????Ä¡ N/A?? Á¸????

age<-c(5, 12, 16, 9, 14)

advertNA<-data.frame(adverts, packetsNA, age)

cor(advertData)

cor(advertNA, use = "everything",  method = "pearson")
# cor(x, y, use= "?????? Ã³?? ????", method = "???????? Á¾??")
# x?? ??Ä¡ ???? ?Ç´? ?????? ?Á·??? / y?? ?Ù¸? ??Ä¡ ???? (x?? ???????Á·????Ì¸? y?? ??Á¤?? ?Ê¿ä°¡ ??À½)
# cor?Ô¼??? ????Æ®?? pearson?????Ð¼? / ?Ù¸? ????(e.g. spearman)À» ???Á¸? ??Á¢ ?????????? ??
# use="everything" ?Ì¶??? Á¶??À» ?Î¿??ß±? ?????? ????Ä¡?? ?Ö´? ??Ã¼?? ???? ???? ?????? NA?? ??????


## ?Ç¾î½¼ ?????Ð¼?(?Ï¹????? ?????Ð¼?)

# cor(x,y, use = "everything", method = "pearson")
# use="" Á¶?Ç½?Àº ?????? Ã³??????(4????)À» ?Ç¹???.
# "everything"(default)Àº ???????? ??À¸?? NA?? ???? / all.obs=???? ??????À» ?????Ï·? ??, ?????? ??À¸?? ?À·?
# complete.obs= ???????? ?Ö´? ???Ì½? ???? Á¦?? / pairwise.compete.obs= ?????????? ?????Ç´? ?????? ???îµ¥ ?????? ?Ö´? ???Ì½???(N/A??) Á¦??

examData = read.delim("Exam Anxiety.dat",  header = TRUE)
examData

cor(examData$Exam, examData$Anxiety, use = "complete.obs", method = 'pearson')
# exam?? anxiety?? ?????????? ???À´? ????

examData2 <- examData[, c("Exam", "Anxiety", "Revise")]
# ?????Í¸? ?Ð¸??Ø³? (????Ã´?? Á¦??)

cor(examData2)

cor(examData[, c("Exam", "Anxiety", "Revise")])
# À§?? ????À» ?Ù¸? ????À¸?? ?Úµ?


# ???????? À¯?Ç¼? ?Ë»?
cor.test(examData$Exam, examData$Anxiety, use = "complete.obs", method = 'pearson')
# ???????? r ?? -0.44?? ???Ô°?, t??Á¤???è·®Àº -4.938?? ???Ê²????Îº??? ?Ó°?Á¡?? t(0.025,101)=-0.584???? ?? ?Û±? ?????? 95% ?Å·Ú¼??Ø¿??? ????Àº À¯????
# -0.4409934*sqrt(101/(1-(0.4409934^2)) = -4.938


## ???Ç¾î¸¸ ?????Ð¼?-?????? Ã´???? ????Ã´???? ????

liarData = read.delim("The Biggest Liar.dat",  header = TRUE)
liarData

cor(liarData$Position, liarData$Creativity, method = "spearman")
# method?? spearmanÀ¸?? ??Á¤?Ï¸? ?????????? ??????
# À½???Ì¹Ç·? ???? ???????è°¡ ??À» ??À¸?? ??Á¤??

cor.test(liarData$Position, liarData$Creativity, method = "spearman") 
# ???Ç¾??? ?????Ð¼??? ???? ????Æ®???? ??????Á¤??
# p-value?? ?Û±? ?????? ?????Ð¼? ???? ??Ã¼?? À¯???Ï¸? rho??(????????)?? -0.37?? ??????
# ?×·??? ?????????? ?? ?????????? ?????? ?Ö´Ù¶??? ?????? Ã¤?Ãµ?

cor.test(liarData$Position, liarData$Creativity, alternative = "less", method = "spearman")  
cor.test(liarData$Position, liarData$Creativity, alternative = "greater", method = "spearman") 
# ???? ??????Á¤À» ?Ï·Á¸? alternative="less"???? Á¶?Ç½?À», ?À¸??? ??????Á¤À» ?Ï·Á¸? alternative = "greater"???? Á¶?Ç½?À» ?ß°???

# ???????? À¯??È®??
liarMatrix<-as.matrix(liarData[, c("Position", "Creativity")])
rcorr(liarMatrix)
# ???????Á·???À» ???Ä·? ??È¯?? ?? rcorr() ?Ô¼? ?Ì¿?


#****************?Ë´?Å¸?? ???????? - ??À§ ?? ???Ì¸? ???? ?????????? ?????Ø³??? ????**************

cor(liarData$Position, liarData$Creativity, method = "kendall")
cor.test(liarData$Position, liarData$Creativity, alternative = "less", method = "kendall")

cor(advertData$adverts, advertData$packets, method = "kendall")
cor.test(advertData$adverts, advertData$packets, alternative = "greater", method = "kendall")


#***************???????Ð¼? - Á¦3 ?????? ??????À» Á¦???Ï°? ??À» ??***************

examData = read.delim("Exam Anxiety.dat",  header = TRUE)
maleExam<-subset(examData, Gender == "Male", select= c("Exam", "Anxiety"))
femaleExam<-subset(examData, Gender == "Female", select= c("Exam", "Anxiety"))
cor(maleExam)
cor(femaleExam)

examData2 <- examData[, c("Exam", "Anxiety", "Revise")]
library(ggm)
pc<-pcor(c("Exam", "Anxiety", "Revise"), var(examData2)) 
# ?????????? pcor() / ?????????? À¯?Ç¼? ???? pcor.test()
# pcor(c(var1, var2, contro1, control2), var(dataframe))


# ???????Ð¼? ????????

pc
# ?????????? ????

pc^2
# ?????????? Á¦??À» ?Ï¸? ?? ?????? ???????? ??

pcor.test(pc, 1, 103) 
# pcor.test(pcor?? ???? ??Ã¼, Á¦?? ?????? ????, Ç¥?? Å©??)
# 'Revise'???? z?????? Á¦???Ï°íµµ exam?? anxiety?? ?????? ?????????? ?????? À¯?Ç¹??Ï´? ???? ?????? ?? ??À½